{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016/03/24/a-leap-in-rx-js/","result":{"data":{"site":{"siteMetadata":{"title":"blog.nojaf.com","author":"Florian Verdonck"}},"markdownRemark":{"id":"ae8e8472-af38-5834-ab84-76706e85daea","excerpt":"Introduction A while ago I wrote some JavaScript to create a custom slideshow. I recently had to revisit that project and I saw an opportunity to fiddle around…","html":"<h2>Introduction</h2>\n<p>A while ago I wrote some JavaScript to create a custom slideshow. I recently had to revisit that project and I saw an opportunity to fiddle around with <a href=\"https://github.com/Reactive-Extensions/RxJS\">RxJS</a></p>\n<h2>Explaining the problem</h2>\n<p>The way the slideshow works is that it shows three images and moves up one frame at a time.<br>\nSo initially the first three images are shown and the rest are hidden.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/09b2882a3ce0ec9b0b5802a3089f867d/22cd6/nojaf-slideshow-example.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.335301062573787%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABdElEQVQY002Ry0rCURCHz3u4cOvCQHsMhaTQbuBCUMGd6cadi3yGatfFLnZ1W1maEWWllmbRBdpEFkVXMzWrr3P+KDQwDDNz5mN+c0T964dKtU5NxvL9IyOjY8TmF1leiTMXW2B8YpKp6DRLy3FSW9ucX1xSKJbY29unfPdArfHNx2eDz3oTiUDcSUi19kVTJoXiKSaTCZfLRTy+QjQapae7G4fdjtPpJBKJEA6HGRwYwNbVRXp7BzmmAZ9e3ri8ukbMzMZQ1mj+kj8+wWAwYLFYCAQCuN0egsEgNpsNh8PBcAvo8/mwWq0kU2m+f9GW2dnN0NvXj3j/qGmSVSObL6DX69HpdAghMJs78Xg8eL1eCXfjHxoiFArh9/vpMBpJbCS1ZSotxvNrBaHktm+gCuvy0epagrXEJgfZPPuHOel5iqUz7STZ3BG7mQM2k2lubu9Rf6DmFUcxRDtpQ/+buk9V1irVBu9yAyVNKflp9f/DVFT+BxnXgVGO77YOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"slideshow example\"\n        title=\"slideshow example\"\n        src=\"/static/09b2882a3ce0ec9b0b5802a3089f867d/799d3/nojaf-slideshow-example.png\"\n        srcset=\"/static/09b2882a3ce0ec9b0b5802a3089f867d/00d96/nojaf-slideshow-example.png 148w,\n/static/09b2882a3ce0ec9b0b5802a3089f867d/0b23c/nojaf-slideshow-example.png 295w,\n/static/09b2882a3ce0ec9b0b5802a3089f867d/799d3/nojaf-slideshow-example.png 590w,\n/static/09b2882a3ce0ec9b0b5802a3089f867d/22cd6/nojaf-slideshow-example.png 847w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>You press the right button to move forward and the left to move backwards. Of course at the beginning of the slideshow you can’t move backwards. Thus the left button is hidden. Once you are at the end of the slideshow you don’t see the right button anymore.</p>\n<h2>The initial approach</h2>\n<p>We keep track of the current index (starting at zero). When one of the buttons is clicked, we update the index, validate whether the index is still in range, show the correct images and update the buttons.</p>\n<p>It looked like:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> maxLength <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">initCategory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        maxLength <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".project-category\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#right-arrow\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            index<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n            index <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">&lt;</span> maxLength <span class=\"token operator\">?</span> index <span class=\"token operator\">:</span> maxLength <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">changeImages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">showArrows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#left-arrow\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            index<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n            index <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">?</span> index <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">changeImages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">showArrows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">changeImages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".project-category\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".project-category\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".project-category\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".project-category\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>index <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">showArrows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#left-arrow,#right-arrow\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#left-arrow\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">&lt;</span> maxLength <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#right-arrow\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    window<span class=\"token punctuation\">.</span>onload <span class=\"token operator\">=</span> initCategory<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>The downside</h3>\n<p>The index was somewhat a global variable, <em>ok all the code was in a closure but all of the code depends on a single variable.</em></p>\n<p>I had two click handlers that were way too similar.</p>\n<h2>A new requirement</h2>\n<p>In order to improve the user experience I wanted the slideshow to work with the arrow keys as well.</p>\n<p>You guessed it, it led to another event handler (keyup) that modified the index variable and called the <code class=\"language-text\">changeImages</code> and <code class=\"language-text\">showArrows</code> function. It was slowly becoming a mess.</p>\n<h2>Enter RxJS</h2>\n<p>When I needed to add support for the arrow keys it started to become clear that we are only interested in the changes to the index. Each change is an event (click or keyup) that either goes forward or backwards. The sum of all the changes is the current state of the index.</p>\n<p>So what if we could map every click on the left button to -1 and every click on the right to +1?</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> leftArrow <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".left\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">var</span> rightArrow <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".right\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> rightClickSource <span class=\"token operator\">=</span> Rx<span class=\"token punctuation\">.</span>Observable  \n  <span class=\"token punctuation\">.</span><span class=\"token function\">fromEvent</span><span class=\"token punctuation\">(</span>rightArrow<span class=\"token punctuation\">,</span> <span class=\"token string\">\"click\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> leftClickSource <span class=\"token operator\">=</span> Rx<span class=\"token punctuation\">.</span>Observable  \n  <span class=\"token punctuation\">.</span><span class=\"token function\">fromEvent</span><span class=\"token punctuation\">(</span>leftArrow<span class=\"token punctuation\">,</span> <span class=\"token string\">\"click\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>And each time an arrow key is pressed, we’d like to keep track of that too.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> arrowKeysSource <span class=\"token operator\">=</span> Rx<span class=\"token punctuation\">.</span>Observable  \n  <span class=\"token punctuation\">.</span><span class=\"token function\">fromEvent</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">,</span> <span class=\"token string\">\"keyup\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> e<span class=\"token punctuation\">.</span>keyCode <span class=\"token operator\">===</span> <span class=\"token number\">37</span> <span class=\"token operator\">||</span> e<span class=\"token punctuation\">.</span>keyCode <span class=\"token operator\">===</span> <span class=\"token number\">39</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>keyCode <span class=\"token operator\">===</span> <span class=\"token number\">39</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Rx Marbles</h3>\n<p>One very helpful site to wrap your head around all the RxJS functions is <a href=\"http://rxmarbles.com/\">RxMarbles</a>.</p>\n<p>To determine the value of my index I need to do a <strong>merge</strong> and a <strong>scan</strong> on my sources.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d4c6a4e1b360ecf7f6e87bf38c27f7cc/c87be/merge.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.19105199516324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABdklEQVQoz5VSa08bMRC8//+P+NBWQmoRBQFqKREQkuaSHo2Pq30Xv1/D2lAEiAp1pdFY9u5od9ZNDAlsWkOaCd4oSL5GSBmyW8MrCaEMfg0CKUb8FitoqxBCgPf+BYwxlZvkgbP1J3S8hRZbsJuPsBHYHhCzW9wwjv3ZEomSvy72MIxbOOOgtILW+gnDMEBKSYKJqv8R+T/vSzTWuqosaTylFFQ5E7QP6L98AJ/PIF3ANE1IzuDzVYuj+QbRWezkQ03J7/u+5jRl7kj+vIVgDSK9l45yzkgpwToPS3fpdS75WrgKvhzkkfMDl3fGWEUIHu9FUwwtGilmhJhAC66FxdmC0pUjOzjnyH/tzumpo8IFJa92GFzCrDvEVnTQY4++PaSREu7OT8CP9rG8nuO0ZUhUdNkd4HixwFU3IJCH6tmWhRDVTxKMWLJzDLseevcH/PY7Cca6jOnHCTarFhfdHby1+Mm+4WKzwYqJKqjp75lHjONYBe8BWLG2zLUdq18AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"merge\"\n        title=\"merge\"\n        src=\"/static/d4c6a4e1b360ecf7f6e87bf38c27f7cc/799d3/merge.png\"\n        srcset=\"/static/d4c6a4e1b360ecf7f6e87bf38c27f7cc/00d96/merge.png 148w,\n/static/d4c6a4e1b360ecf7f6e87bf38c27f7cc/0b23c/merge.png 295w,\n/static/d4c6a4e1b360ecf7f6e87bf38c27f7cc/799d3/merge.png 590w,\n/static/d4c6a4e1b360ecf7f6e87bf38c27f7cc/c87be/merge.png 827w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9f45856ce47788a348bd20253f532b44/2cc4f/scan.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.74576271186441%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABJ0lEQVQoz2VRy07DMBDM//8OFwRIhUNB3OBWEKigiubpxHH8jpPBa9KqpZbGG8/OesebzDkH5z1MlUMMA0quwFWNXrUwooS1OuWTLkKVezhjzjiCiZy1FlkSaYN+fYPv3Q6rTYG34hHv5SvE1z1EX0WxhdYaOhbVD9eQLYO2C7eg6zr0fY/Mx060Jlyu+fR7nmn7x13WJId/N06paI6xbVvkRYGmrqCUghDi6EQpmZ7GOUcI4djsgIxE5NLFgx8D3DQjeAfvLIybYJf5HGYV/ByjP3JUe4qMug1SolnfgX1sIJ5XePr8wcs2B9/egnfk0kBGjZIq5q7AeAWduCHxBMZYmmNGtsmqbUqMasDY1mDSxD9t47lAGH3KT8tIGrnHGM45inQP4RepUB0MhEyt3wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"scan\"\n        title=\"scan\"\n        src=\"/static/9f45856ce47788a348bd20253f532b44/799d3/scan.png\"\n        srcset=\"/static/9f45856ce47788a348bd20253f532b44/00d96/scan.png 148w,\n/static/9f45856ce47788a348bd20253f532b44/0b23c/scan.png 295w,\n/static/9f45856ce47788a348bd20253f532b44/799d3/scan.png 590w,\n/static/9f45856ce47788a348bd20253f532b44/2cc4f/scan.png 826w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> source <span class=\"token operator\">=</span> Rx<span class=\"token punctuation\">.</span>Observable  \n  <span class=\"token punctuation\">.</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>rightClickSource<span class=\"token punctuation\">,</span> leftClickSource<span class=\"token punctuation\">,</span> arrowKeysSource<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">scan</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> currentValue</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> nextValue <span class=\"token operator\">=</span> acc <span class=\"token operator\">+</span> currentValue<span class=\"token punctuation\">;</span>\n    nextValue <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>nextValue <span class=\"token operator\">&lt;</span> maxLength <span class=\"token operator\">?</span> nextValue <span class=\"token operator\">:</span> maxLength <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    nextValue <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>nextValue <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token operator\">?</span> nextValue <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> nextValue<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">startWith</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Notice that I do some validation in my scan callback.</p>\n<h3>Subscribe!</h3>\n<p>The missing piece of the puzzle is now to trigger the <code class=\"language-text\">changeImages</code> and <code class=\"language-text\">showArrows</code> functions. We can do this by <em>subscribing</em> to <code class=\"language-text\">source</code> observable.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">source.subscribe((next) => {  \n  changeImages(next);\n  showArrows(next);\n});</code></pre></div>\n<h2>The Source</h2>\n<p>I’ve created a <a href=\"https://jsfiddle.net/46am0wmf/14/\">jsfiddle</a> with the result.</p>\n<h2>Remarks</h2>\n<ul>\n<li>I really learned a lot by this little experiment and I encourage you to definitely check out RxJS</li>\n<li>The final example doesn’t use jQuery and is written with Babel.</li>\n<li>Please correct me if you find any mistakes.</li>\n</ul>\n<h2>Final words</h2>\n<p>RxJS rocks! If you have any suggestions or questions please leave a comment.</p>\n<p>Yours truly,<br>\nnojaf</p>","frontmatter":{"title":"A leap in RxJS","date":"2016-03-24","path":"2016/03/24/a-leap-in-rx-js/","tags":["javascript","rxjs"],"cover":{"publicURL":"/static/nojaf-com-rxjs-banner-e2d6b3913f3b2b4d58982ac3a58103ce.jpg"}}}},"pageContext":{"slug":"/leap-rxjs/","previous":{"fields":{"slug":"/redux-thunk/"},"frontmatter":{"title":"Redux Thunk, javascript middleware for Redux","path":"2015/12/06/redux-thunk/","tags":["javascript"]}},"next":{"fields":{"slug":"/laradock-windows-10/"},"frontmatter":{"title":"Running Laravel projects on Windows 10 using Docker","path":"2016/08/19/laradock-on-windows-10/","tags":["laravel","docker","php","laradock","how-to"]}}}}}